#!/usr/bin/env bash
# Author: Bruno Guimarães
# Description:
# Version: 1.0
# Last Updated: 2025-12-10

set -euo pipefail
IFS=$'\n\t'

# ──────────────────────────────────────────────────────────────────────────────
# Functions
# ──────────────────────────────────────────────────────────────────────────────
ensure_args() {
  if [ $# -ne 1 ]; then
    echo "Usage: $(basename "$0") <source_file.c>" >&2
    return 1
  fi
}

build_and_execute() {
  # Extract file name without extension
  local file="$1"
  local base_name="$(basename "$file")"
  local output_name="${base_name%.*}"

  echo "Compiling program.."
  # Build the C program
  cc -Wall -Wextra -pedantic -o "$output_name" "$file"

  echo "Launching program.."
  # Run it
  "./$output_name"
}

# ──────────────────────────────────────────────────────────────────────────────
# Main
# ──────────────────────────────────────────────────────────────────────────────
main() {
  ensure_args "$@" || exit 1
  build_and_execute "$1"
}

# ──────────────────────────────────────────────────────────────────────────────
# Entry Point
# ──────────────────────────────────────────────────────────────────────────────
# Only run main if script is executed (not sourced)
[[ "${BASH_SOURCE[0]}" == "${0}" ]] && main "$@"
