#!/usr/bin/env bash

## Author  : Bruno Guimarães - fork from -> Aditya Shakya (adi1090x)
# Depends on: https://github.com/adi1090x/rofi

# Import Theme
type="$HOME/.config/rofi/applets/type-5"
style='stylebrlk.rasi'
theme="$type/$style"

list_col='1'
list_row='8'
efonts="JetBrains Mono Nerd Font 10"

# Rofi CMD
rofi_cmd() {
	rofi -theme-str "listview {columns: $list_col; lines: $list_row;}" \
		-theme-str 'textbox-prompt-colon {str: "";}' \
		-theme-str "element-text {font: \"$efonts\";}" \
		-dmenu \
        -i \
		-markup-rows \
		-theme ${theme}
}

# Operation CMD
operation_cmd() {
    # Import Theme
    type="$HOME/.config/rofi/applets/type-1"
    style='style-3.rasi'
    theme="$type/$style"
	rofi -theme-str 'window {location: center; anchor: center; fullscreen: false; width: 350px;}' \
		-theme-str 'mainbox {orientation: vertical; children: [ "message", "listview" ];}' \
		-theme-str 'listview {columns: 2; lines: 1;}' \
		-theme-str 'element-text {horizontal-align: 0.5;}' \
		-theme-str 'textbox {horizontal-align: 0.5;}' \
		-dmenu \
		-p 'Confirmation' \
		-mesg 'Turn the container' \
		-theme ${theme}
}

CHOICE=$(for f in ~/.utils/DockerContainers/*.yml; do basename "${f%.yml}"; done | rofi_cmd)
[[ -z "$CHOICE" ]] && exit 0

OPERATION="$(echo -e "Up\nDown" | operation_cmd)"
[[ -z "$OPERATION" ]] && exit 0

if [[ "$OPERATION" == "Up" ]]; then
    docker-compose -f ~/.utils/DockerContainers/${CHOICE}.yml up -d
elif [[ "$OPERATION" == "Down" ]]; then
    docker-compose -f ~/.utils/DockerContainers/${CHOICE}.yml down
else
    exit
fi
